### 一、ODS 表设计

ODS 层主要用于存储从各个数据源直接采集的原始数据，不做过多的处理，保留数据的原始形态。



1. **用户行为日志表（ods_user_action_log）**

    - **字段**：
        - `action_id`：行为记录唯一标识，字符串类型
        - `user_id`：用户唯一标识，字符串类型
        - `action_type`：行为类型（点击、浏览、搜索、收藏、加购、下单、支付、商品评价等），字符串类型
        - `item_id`：商品唯一标识，字符串类型
        - `category_id`：商品类目唯一标识，字符串类型
        - `brand_id`：品牌唯一标识，字符串类型
        - `action_time`：行为发生时间，时间类型
        - `device_type`：设备类型（iOS 设备、Android 设备、桌面端），字符串类型
        - `system_version`：操作系统版本，字符串类型
        - `extra_info`：其他额外信息，字符串类型
    - **用途**：记录用户在淘宝平台上的所有行为日志，作为后续数据处理的基础。
    - **更新频率**：实时采集用户行为数据，按天分区存储
2. **用户资料表（ods_user_profile）**

    - **字段**：
        - `user_id`：用户唯一的标识，字符串类型
        - `birth_day`：生日，
        - `gender`：性别，字符串类型（男、女、未知）
        - `other_info`：其他个人信息，字符串类型
    - **用途**：存储用户主动填写或设备同步的个人资料信息。
    - **更新频率**：用户资料发生变化时实时更新，每日凌晨全量刷新
3. **商品类目表（ods_item_category）**

    - **字段**：
        - `category_id`：类目唯一标识，字符串类型
        - `category_name`：类目名称，字符串类型
        - `parent_category_id`：父类目唯一标识，字符串类型
        - `category_level`：类目层级，整数类型
        - `category_desc`：类目描述，字符串类型
    - **用途**：记录商品类目的基本信息，用于关联用户行为数据和商品数据。
    - **更新频率**：商品类目信息发生变化时实时更新，每周全量刷新
4. **商品信息表（ods_item_info）**

    - **字段**：
        - `item_id`：商品唯一标识，字符串类型
        - `item_name`：商品名称，字符串类型
        - `category_id`：商品所属类目唯一标识，字符串类型
        - `brand_id`：商品品牌唯一标识，字符串类型
        - `price`：商品价格，数值类型
        - `item_desc`：商品描述，字符串类型
        - `other_info`：其他商品相关信息，字符串类型
    - **用途**：存储商品的基本信息，用于分析用户的购买偏好。
    - **更新频率**：商品信息发生变化时实时更新，每日凌晨全量刷新

### 二、DWD 表设计

DWD 层对 ODS 层的数据进行清洗、转换和关联，形成较为规范的明细数据。



1. **用户行为明细表（dwd_user_action_detail）**

    - **字段**：
        - `action_id`：行为记录唯一标识，字符串类型
        - `user_id`：用户唯一标识，字符串类型
        - `action_type`：行为类型（点击、浏览、搜索、收藏、加购、下单、支付、商品评价等），字符串类型
        - `item_id`：商品唯一标识，字符串类型
        - `category_id`：商品类目唯一标识，字符串类型
        - `brand_id`：品牌唯一标识，字符串类型
        - `action_time`：行为发生时间，时间类型
        - `device_type`：设备类型（iOS 设备、Android 设备、桌面端），字符串类型
        - `system_version`：操作系统版本，字符串类型
        - `user_age`：用户年龄，整数类型（根据出生年份计算）
        - `user_gender`：用户性别，字符串类型（女性用户、男性用户、家庭用户）
        - `user_weight`：用户体重，数值类型（单位：千克）
        - `user_height`：用户身高，整数类型（单位：厘米）
        - `user_constellation`：用户星座，字符串类型（摩羯座、水瓶座等）
    - **用途**：将用户行为数据与用户资料数据进行关联，形成包含用户基本信息的行为明细表，用于后续的分析和计算。
    - **更新频率**：基于 ODS 层数据每日凌晨全量更新
2. **用户购买行为明细表（dwd_user_purchase_detail）**

    - **字段**：
        - `purchase_id`：购买记录唯一标识，字符串类型
        - `user_id`：用户唯一标识，字符串类型
        - `item_id`：商品唯一标识，字符串类型
        - `category_id`：商品类目唯一标识，字符串类型
        - `brand_id`：品牌唯一标识，字符串类型
        - `purchase_time`：购买时间，时间类型
        - `purchase_amount`：购买金额，数值类型
        - `payment_method`：支付方式，字符串类型
        - `shipping_address`：收货地址，字符串类型
        - `user_age`：用户年龄，整数类型
        - `user_gender`：用户性别，字符串类型（女性用户、男性用户、家庭用户）
        - `user_weight`：用户体重，数值类型（单位：千克）
        - `user_height`：用户身高，整数类型（单位：厘米）
        - `user_constellation`：用户星座，字符串类型（摩羯座、水瓶座等）
    - **用途**：专门记录用户的购买行为明细，便于分析用户的购买偏好和消费习惯。
    - **更新频率**：基于 ODS 层数据每日凌晨全量更新
3. **商品类目偏好表（dwd_user_category_preference）**

    - **字段**：
        - `user_id`：用户唯一标识，字符串类型
        - `category_id`：商品类目唯一标识，字符串类型
        - `preference_score`：偏好得分，数值类型
        - `behavior_count`：涉及该类目的行为次数，整数类型
        - `last_action_time`：最后一次涉及该类目的行为时间，时间类型
        - `user_age`：用户年龄，整数类型
        - `user_gender`：用户性别，字符串类型（女性用户、男性用户、家庭用户）
        - `user_weight`：用户体重，数值类型（单位：千克）
        - `user_height`：用户身高，整数类型（单位：厘米）
        - `user_constellation`：用户星座，字符串类型（摩羯座、水瓶座等）
    - **用途**：统计用户对各个商品类目的偏好程度，为精准广告投放提供参考。
    - **更新频率**：基于用户行为数据每日凌晨全量更新

### 三、DWS 表设计

DWS 层对 DWD 层的数据进行汇总和统计，形成面向主题的汇总数据。



1. **用户年龄分布表（dws_user_age_distribution）**

    - **字段**：
        - `age_group`：年龄段（18-24 岁、25-29 岁、30-34 岁、35-39 岁、40-49 岁、50 岁以上），字符串类型
        - `user_count`：该年龄段的用户数量，整数类型
        - `action_count`：该年龄段用户的行为总次数，整数类型
        - `purchase_count`：该年龄段用户的购买总次数，整数类型
        - `purchase_amount`：该年龄段用户的购买总金额，数值类型
    - **用途**：统计不同年龄段的用户数量、行为次数、购买次数和购买金额，分析各年龄段的消费特征。
    - **更新频率**：每日凌晨基于 DWD 层数据进行汇总更新
2. **用户性别行为表（dws_user_gender_action）**

    - **字段**：
        - `user_gender`：用户性别（女性用户、男性用户、家庭用户），字符串类型
        - `action_type`：行为类型（点击、浏览、搜索、收藏、加购、下单、支付、商品评价等），字符串类型
        - `action_count`：该性别用户的行为次数，整数类型
        - `category_count`：涉及的商品类目数量，整数类型
        - `brand_count`：涉及的品牌数量，整数类型
    - **用途**：统计不同性别用户的各种行为次数以及涉及的商品类目和品牌数量，了解性别对用户行为的影响。
    - **更新频率**：每日凌晨基于 DWD 层数据进行汇总更新
3. **用户设备使用表（dws_user_device_usage）**

    - **字段**：
        - `device_type`：设备类型（iOS 设备、Android 设备、桌面端），字符串类型
        - `user_count`：使用该设备的用户数量，整数类型
        - `action_count`：该设备上的行为总次数，整数类型
        - `purchase_count`：该设备上的购买总次数，整数类型
        - `system_version`：操作系统版本，字符串类型
    - **用途**：统计不同设备类型的用户数量、行为次数和购买次数，分析设备类型对用户行为的影响。
    - **更新频率**：每日凌晨基于 DWD 层数据进行汇总更新
4. **用户星座消费表（dws_user_constellation_consumption）**

    - **字段**：
        - `constellation`：星座（摩羯座、水瓶座等），字符串类型
        - `user_count`：该星座的用户数量，整数类型
        - `purchase_count`：该星座用户的购买总次数，整数类型
        - `purchase_amount`：该星座用户的购买总金额，数值类型
        - `average_purchase_amount`：该星座用户的平均购买金额，数值类型
    - **用途**：统计不同星座用户的购买次数和购买金额，分析星座与消费行为的关系。
    - **更新频率**：每日凌晨基于 DWD 层数据进行汇总更新

### 四、ADS 表设计

ADS 层主要为应用层提供数据支持，根据具体的业务需求进行定制化设计。



1. **广告投放用户画像表（ads_advertising_user_profile）**

    - **字段**：
        - `user_id`：用户唯一标识，字符串类型
        - `user_age`：用户年龄，整数类型
        - `user_gender`：用户性别，字符串类型（女性用户、男性用户、家庭用户）
        - `user_weight`：用户体重，数值类型（单位：千克）
        - `user_height`：用户身高，整数类型（单位：厘米）
        - `user_constellation`：用户星座，字符串类型（摩羯座、水瓶座等）
        - `device_type`：设备类型（iOS 设备、Android 设备、桌面端），字符串类型
        - `category_preference`：商品类目偏好，字符串类型（如：时尚与潮流、性价比等）
        - `brand_preference`：品牌偏好，字符串类型
        - `price_sensitivity`：价格敏感度，数值类型
        - `time_behavior`：时间行为（凌晨、早晨、上午、中午、下午、晚上、夜间），字符串类型
        - `social_interaction`：社交互动行为（参与直播、发表评论、分享商品、加入社区讨论、关注达人 / 店铺），字符串类型
    - **用途**：为广告投放提供用户画像信息，帮助商家精准定位目标用户，优化广告投放策略。
    - **更新频率**：每日凌晨基于 DWS 层数据进行更新
2. **广告投放效果分析表（ads_advertising_effect_analysis）**

    - **字段**：
        - `ad_id`：广告唯一标识，字符串类型
        - `campaign_id`：广告活动唯一标识，字符串类型
        - `user_id`：用户唯一标识，字符串类型
        - `action_type`：用户对广告的行为类型（点击、浏览、收藏、加购、下单等），字符串类型
        - `conversion_rate`：转化率，数值类型
        - `cost_per_action`：每次行为的成本，数值类型
        - `revenue`：广告带来的收益，数值类型
        - `ROI`：投资回报率，数值类型
        - `target_age_group`：目标年龄段（18-24 岁、25-29 岁等），字符串类型
        - `target_gender`：目标性别（女性用户、男性用户、家庭用户），字符串类型
        - `target_device_type`：目标设备类型（iOS 设备、Android 设备、桌面端），字符串类型
    - **用途**：分析广告投放的效果，评估广告活动的投资回报率，为后续广告投放策略的优化提供依据。
    - **更新频率**：广告投放过程中实时记录用户行为，每日凌晨汇总计算广告效果指标


1. **项目背景**：随着电商平台的发展，为了提高广告投放的精准度和效果，需要构建一个精准的用户画像标签体系，通过对用户行为数据和个人资料数据的分析，为商家提供更有针对性的广告投放策略，从而吸引更多商家在平台上投放广告。
2. **数据来源**：
    - 用户在淘宝平台上的行为日志数据，包括点击、浏览、搜索、收藏、加购、下单、支付、商品评价等。
    - 用户主动填写的个人资料数据，如生日、性别、体重、身高、星座等。
    - 商品类目和商品信息数据，用于关联用户行为和商品属性。
3. **数据处理流程**：
    - **ODS 层**：从各个数据源采集原始数据，按天分区存储，不做过多处理，保留数据的原始形态。
    - **DWD 层**：对 ODS 层的数据进行清洗、转换和关联，去除无效数据，统一数据格式，形成规范的明细数据。
    - **DWS 层**：对 DWD 层的数据进行汇总和统计，按照不同的主题进行聚合，生成面向主题的汇总数据。
    - **ADS 层**：根据具体的业务需求，从 DWS 层提取相关数据，进行定制化处理，为广告投放和效果分析提供数据支持。
4. **数据更新策略**：
    - ODS 层实时采集用户行为数据，每日凌晨全量刷新用户资料数据。
    - DWD 层每日凌晨基于 ODS 层数据进行全量更新。
    - DWS 层每日凌晨基于 DWD 层数据进行汇总更新，部分指标实时更新。
    - ADS 层每日凌晨基于 DWS 层数据进行更新，广告投放效果指标实时记录并每日凌晨汇总计算。
5. **数据质量保证**：
    - 在数据采集阶段，对数据进行合法性检查，确保数据的完整性和准确性。
    - 在数据清洗阶段，去除无效数据，处理异常值，统一数据格式。
    - 在数据处理过程中，对数据进行校验和验证，确保数据的一致性和准确性。
    - 定期对数据进行质量评估，及时发现和解决数据质量问题。
6. **安全与隐私保护**：
    - 对用户敏感信息进行加密处理，确保数据的安全性。
    - 严格控制数据访问权限，只有授权人员才能访问用户数据。
    - 遵循相关法律法规，保护用户的隐私权利